<!DOCTYPE html>
<html lang="pl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dziennik Treningowy: PPL + Upper</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700;900&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
            -webkit-tap-highlight-color: transparent;
        }
        .chart-container {
            position: relative;
            width: 100%;
            max-width: 600px;
            margin-left: auto;
            margin-right: auto;
            height: 350px;
            max-height: 450px;
        }
        @media (min-width: 768px) {
            .chart-container {
                height: 400px;
            }
        }
        .gradient-text {
            background: linear-gradient(to right, #118AB2, #06D6A0);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }
        .gemini-btn {
            background-color: #E0F2FE;
            color: #0C4A6E;
            transition: all 0.2s ease-in-out;
            padding: 4px 8px;
            font-size: 12px;
            border-radius: 6px;
            font-weight: 600;
        }
        .gemini-btn:hover {
            background-color: #BAE6FD;
            transform: scale(1.05);
        }
        .save-btn {
            background-color: #118AB2;
            color: white;
            padding: 8px 16px;
            border-radius: 6px;
            font-weight: 600;
            transition: background-color 0.2s;
        }
        .save-btn:hover {
            background-color: #0F7194;
        }
        .save-btn.saved {
            background-color: #06D6A0;
        }
        .weight-input {
            width: 80px;
            padding: 8px;
            border: 1px solid #CBD5E1;
            border-radius: 6px;
            text-align: center;
        }
        .loader {
            border: 4px solid #f3f3f3;
            border-top: 4px solid #118AB2;
            border-radius: 50%;
            width: 32px;
            height: 32px;
            animation: spin 1s linear infinite;
        }
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
    </style>
</head>
<body class="bg-gray-100 text-[#073B4C]">
    <div id="gemini-modal" class="fixed inset-0 bg-black bg-opacity-50 z-50 hidden items-center justify-center p-4">
        <div class="bg-white rounded-lg shadow-xl p-6 w-full max-w-md relative">
            <button id="close-modal-btn" class="absolute top-2 right-4 text-gray-500 hover:text-gray-800 text-3xl font-bold">&times;</button>
            <h3 id="modal-title" class="text-xl font-bold text-[#073B4C] mb-4">Alternatywne ćwiczenia</h3>
            <div id="modal-content" class="min-h-[100px]">
                <div id="modal-loader" class="flex justify-center items-center h-full">
                    <div class="loader"></div>
                </div>
                <div id="modal-text-content" class="text-gray-700 space-y-2 hidden"></div>
            </div>
        </div>
    </div>

    <div class="container mx-auto p-4 md:p-8">

        <header class="text-center mb-12">
            <h1 class="text-4xl md:text-6xl font-black uppercase tracking-wide gradient-text">Twój Dziennik Treningowy</h1>
            <p class="text-xl md:text-2xl font-semibold mt-2 text-[#073B4C]">Rekompozycja Sylwetki: Siła & Hipertrofia</p>
        </header>

        <section class="mb-12 bg-white rounded-lg shadow-md p-6">
            <h2 class="text-2xl font-bold text-center mb-4">Jak korzystać z dziennika?</h2>
            <div class="text-center text-gray-700 space-y-2">
                 <p>Wpisz ciężar (w kg) w pole przy każdym ćwiczeniu i kliknij "Zapisz".</p>
                 <p>Twoje postępy zostaną <span class="font-bold">automatycznie zapisane</span> na tym urządzeniu.</p>
                 <p class="text-sm text-gray-500">Dane nie są synchronizowane między urządzeniami. Przycisk poniżej wyczyści wszystkie zapisane ciężary.</p>
                 <button id="reset-data-btn" class="mt-4 bg-red-500 text-white font-bold py-2 px-4 rounded-lg hover:bg-red-600 transition-colors">Resetuj Zapisane Ciężary</button>
            </div>
        </section>

        <section id="tip-of-the-day-section" class="mb-12">
            <div class="bg-white rounded-lg shadow-md p-6">
                <h2 class="text-2xl font-bold text-center mb-4">✨ Porada Dnia od Gemini</h2>
                <div id="tip-content" class="text-center text-lg text-gray-700 min-h-[50px] flex items-center justify-center">
                    <div class="loader"></div>
                </div>
            </div>
        </section>
        
        <section class="space-y-8">
            <h2 class="text-2xl md:text-3xl font-bold text-center mb-6">Szczegółowy Podział Treningów</h2>
            <div id="exercise-sections" class="grid grid-cols-1 md:grid-cols-2 gap-8">
                <div class="bg-white rounded-lg shadow-lg p-6"><h3 class="text-2xl font-bold mb-4 text-[#FF6B6B]">A: PUSH (Siła i Hipertrofia)</h3><ul class="space-y-4 text-gray-700" data-day="push"></ul></div>
                <div class="bg-white rounded-lg shadow-lg p-6"><h3 class="text-2xl font-bold mb-4 text-[#FFD166]">B: PULL (Szerokość i Grubość)</h3><ul class="space-y-4 text-gray-700" data-day="pull"></ul></div>
                <div class="bg-white rounded-lg shadow-lg p-6"><h3 class="text-2xl font-bold mb-4 text-[#06D6A0]">C: LEGS (Siła i Rozwój)</h3><ul class="space-y-4 text-gray-700" data-day="legs"></ul></div>
                <div class="bg-white rounded-lg shadow-lg p-6"><h3 class="text-2xl font-bold mb-4 text-[#118AB2]">D: UPPER (Hipertrofia)</h3><ul class="space-y-4 text-gray-700" data-day="upper"></ul></div>
            </div>
        </section>

        <section class="grid grid-cols-1 lg:grid-cols-2 gap-8 my-12">
            <div class="bg-white rounded-lg shadow-md p-6">
                <h3 class="text-xl font-bold text-center mb-4">Analiza Częstotliwości Treningu</h3>
                <p class="text-center text-gray-600 mb-4">Ten wykres pokazuje, ile razy w tygodniu trenujesz każdą główną grupę mięśniową.</p>
                <div class="chart-container"><canvas id="frequencyChart"></canvas></div>
            </div>
            <div class="bg-white rounded-lg shadow-md p-6">
                <h3 class="text-xl font-bold text-center mb-4">Podział Celów Treningowych</h3>
                 <p class="text-center text-gray-600 mb-4">Wykres ilustruje proporcje ćwiczeń ukierunkowanych na siłę i hipertrofię.</p>
                <div class="chart-container"><canvas id="repRangeChart"></canvas></div>
            </div>
        </section>
        
        <footer class="text-center mt-12 pt-8 border-t-2 border-gray-200">
             <p class="text-lg font-bold text-[#073B4C]">Klucz do sukcesu: <span class="text-[#118AB2]">Progresywne Przeciążenie</span> i <span class="text-[#06D6A0]">Konsekwencja</span>.</p>
             <p class="text-gray-600 mt-2">Pamiętaj o odpowiedniej diecie i regeneracji, aby zmaksymalizować efekty.</p>
        </footer>
    </div>

    <script>
        const apiKey = "";
        const STORAGE_KEY = 'workoutTrackerData';

        const exercises = {
            push: [
                { name: 'Wyciskanie sztangi płasko', details: '4 serie x 4-6 powt.' },
                { name: 'Wyciskanie hantli skos', details: '4 serie x 8-10 powt.' },
                { name: 'Wyciskanie żołnierskie (OHP)', details: '3 serie x 6-8 powt.' },
                { name: 'Wznosy hantli bokiem', details: '4 serie x 10-15 powt.' },
                { name: 'Pompki na poręczach (dips)', details: '3 serie x 6-10 powt.' },
                { name: 'Francuskie wyciskanie sztangi', details: '3 serie x 10-12 powt.' }
            ],
            pull: [
                { name: 'Podciąganie z obciążeniem', details: '4 serie x 4-6 powt.' },
                { name: 'Wiosłowanie sztangą', details: '4 serie x 6-8 powt.' },
                { name: 'Wiosłowanie hantlem', details: '3 serie x 8-10 powt.' },
                { name: 'Przyciąganie drążka wyciągu', details: '3 serie x 10-12 powt.' },
                { name: 'Uginanie ze sztangą łamaną', details: '4 serie x 8-10 powt.' },
                { name: 'Uginanie z hantlami skos', details: '3 serie x 10-12 powt.' }
            ],
            legs: [
                { name: 'Przysiady ze sztangą', details: '4 serie x 4-6 powt.' },
                { name: 'Rumuński martwy ciąg (RDL)', details: '4 serie x 8-10 powt.' },
                { name: 'Wykroki chodzone', details: '3 serie x 10-12 powt.' },
                { name: 'Uginanie nóg leżąc', details: '4 serie x 10-15 powt.' },
                { name: 'Wspięcia na palce', details: '4 serie x 15-20 powt.' },
                { name: 'Unoszenie nóg w zwisie', details: '3 serie do upadku' }
            ],
            upper: [
                { name: 'Wyciskanie sztangi skos', details: '4 serie x 6-8 powt.' },
                { name: 'Wiosłowanie półsztangą', details: '4 serie x 8-10 powt.' },
                { name: 'Wyciskanie hantli siedząc', details: '3 serie x 10-12 powt.' },
                { name: 'Ściąganie drążka wąsko', details: '3 serie x 10-12 powt.' },
                { name: 'Rozpiętki na maszynie', details: '3 serie x 12-15 powt.' },
                { name: 'Face pulls', details: '4 serie x 15-20 powt.' },
                { name: 'Uginanie młotkowe', details: '3 serie x 10-12 powt.' },
                { name: 'Prostowanie na wyciągu', details: '3 serie x 12-15 powt.' }
            ]
        };

        function populateExercises() {
            const container = document.getElementById('exercise-sections');
            Object.keys(exercises).forEach(day => {
                const ul = container.querySelector(`ul[data-day="${day}"]`);
                if (!ul) return;
                ul.innerHTML = '';
                exercises[day].forEach(ex => {
                    const li = document.createElement('li');
                    li.className = 'p-2 border-b border-gray-200';
                    li.innerHTML = `
                        <div class="flex justify-between items-center mb-2">
                            <span class="font-bold">${ex.name}</span>
                            <button class="gemini-btn" data-exercise-name="${ex.name}">✨ Zamiennik</button>
                        </div>
                        <p class="text-sm text-gray-600 mb-2">${ex.details}</p>
                        <div class="flex items-center gap-2">
                            <input type="number" placeholder="kg" class="weight-input" data-day="${day}" data-exercise-name="${ex.name}">
                            <button class="save-btn" data-day="${day}" data-exercise-name="${ex.name}">Zapisz</button>
                        </div>
                    `;
                    ul.appendChild(li);
                });
            });
        }
        
        function saveWeight(day, exerciseName, weight) {
            const data = JSON.parse(localStorage.getItem(STORAGE_KEY)) || {};
            if (!data[day]) {
                data[day] = {};
            }
            data[day][exerciseName] = weight;
            localStorage.setItem(STORAGE_KEY, JSON.stringify(data));
        }

        function loadWeights() {
            const data = JSON.parse(localStorage.getItem(STORAGE_KEY)) || {};
            document.querySelectorAll('.weight-input').forEach(input => {
                const day = input.dataset.day;
                const exerciseName = input.dataset.exerciseName;
                if (data[day] && data[day][exerciseName]) {
                    input.value = data[day][exerciseName];
                }
            });
        }
        
        async function callGemini(prompt, retries = 3, delay = 1000) {
            const apiUrl = `https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash-preview-05-20:generateContent?key=${apiKey}`;
            try {
                const response = await fetch(apiUrl, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ contents: [{ parts: [{ text: prompt }] }] })
                });
                if (!response.ok) throw new Error(`HTTP error! status: ${response.status}`);
                const result = await response.json();
                return result.candidates?.[0]?.content?.parts?.[0]?.text || "Przepraszam, nie udało mi się wygenerować odpowiedzi.";
            } catch (error) {
                console.error("Error calling Gemini API:", error);
                if (retries > 0) {
                    await new Promise(res => setTimeout(res, delay));
                    return callGemini(prompt, retries - 1, delay * 2);
                }
                return "Wystąpił błąd podczas komunikacji z AI. Spróbuj ponownie później.";
            }
        }
        
        async function getTipOfTheDay() {
            const tipContent = document.getElementById('tip-content');
            const prompt = "Działaj jako ekspert od fitnessu i żywienia. Podaj krótką (1-2 zdania), motywującą i praktyczną poradę dnia dla zaawansowanego mężczyzny, którego celem jest rekompozycja sylwetki (redukcja tłuszczu, budowa mięśni). Porada powinna dotyczyć treningu, diety lub regeneracji. Odpowiedz po polsku.";
            const tip = await callGemini(prompt);
            tipContent.innerHTML = `<p>${tip}</p>`;
        }

        async function getExerciseAlternatives(exerciseName) {
            const modal = document.getElementById('gemini-modal');
            const modalTitle = document.getElementById('modal-title');
            const modalLoader = document.getElementById('modal-loader');
            const modalTextContent = document.getElementById('modal-text-content');

            modalTitle.textContent = `Alternatywy dla: ${exerciseName}`;
            modalLoader.style.display = 'flex';
            modalTextContent.style.display = 'none';
            modalTextContent.innerHTML = '';
            modal.style.display = 'flex';

            const prompt = `Podaj 2-3 skuteczne ćwiczenia alternatywne dla "${exerciseName}", które angażują te same główne grupy mięśniowe. Wylistuj je w punktach. Odpowiedz krótko i zwięźle, po polsku.`;
            const alternatives = await callGemini(prompt);

            const formattedAlternatives = alternatives.split('\n').map(line => line.trim().replace(/^[\*\-]\s*/, '')).filter(line => line.length > 0).map(line => `<li>${line}</li>`).join('');
            modalTextContent.innerHTML = `<ul class="list-disc list-inside">${formattedAlternatives}</ul>`;
            modalLoader.style.display = 'none';
            modalTextContent.style.display = 'block';
        }

        document.addEventListener('DOMContentLoaded', () => {
            populateExercises();
            loadWeights();
            getTipOfTheDay();

            const modal = document.getElementById('gemini-modal');
            const closeModalBtn = document.getElementById('close-modal-btn');
            
            document.getElementById('exercise-sections').addEventListener('click', (e) => {
                const target = e.target;
                if (target.matches('button.gemini-btn')) {
                    const exerciseName = target.dataset.exerciseName;
                    getExerciseAlternatives(exerciseName);
                } else if (target.matches('button.save-btn')) {
                    const day = target.dataset.day;
                    const exerciseName = target.dataset.exerciseName;
                    const input = document.querySelector(`.weight-input[data-day="${day}"][data-exercise-name="${exerciseName}"]`);
                    if (input.value) {
                       saveWeight(day, exerciseName, input.value);
                       target.textContent = 'Zapisano!';
                       target.classList.add('saved');
                       setTimeout(() => {
                           target.textContent = 'Zapisz';
                           target.classList.remove('saved');
                       }, 1500);
                    }
                }
            });
            
            document.getElementById('reset-data-btn').addEventListener('click', () => {
                localStorage.removeItem(STORAGE_KEY);
                document.querySelectorAll('.weight-input').forEach(input => input.value = '');
            });

            closeModalBtn.addEventListener('click', () => modal.style.display = 'none');
            modal.addEventListener('click', (e) => { if (e.target === modal) modal.style.display = 'none' });

            const wrapLabel = (label, maxLength = 16) => { if (label.length <= maxLength) { return label; } const words = label.split(' '); const lines = []; let currentLine = ''; words.forEach(word => { if ((currentLine + word).length > maxLength) { lines.push(currentLine.trim()); currentLine = ''; } currentLine += word + ' '; }); lines.push(currentLine.trim()); return lines; };
            const tooltipTitleCallback = (tooltipItems) => { const item = tooltipItems[0]; let label = item.chart.data.labels[item.dataIndex]; return Array.isArray(label) ? label.join(' ') : label; };
            const defaultChartOptions = { responsive: true, maintainAspectRatio: false, plugins: { legend: { position: 'bottom', labels: { font: { family: "'Inter', sans-serif", size: 12 }, color: '#073B4C' }}, tooltip: { callbacks: { title: tooltipTitleCallback }, bodyFont: { family: "'Inter', sans-serif" }, titleFont: { family: "'Inter', sans-serif" }} } };
            
            const frequencyCtx = document.getElementById('frequencyChart').getContext('2d');
            new Chart(frequencyCtx, { type: 'bar', data: { labels: ['Klatka', 'Plecy', 'Barki', 'Biceps', 'Triceps', 'Nogi'], datasets: [{ label: 'Ilość sesji w tygodniu', data: [2, 2, 2, 2, 2, 1], backgroundColor: ['#FF6B6B', '#FFD166', '#06D6A0', '#118AB2', '#073B4C', '#FF8C42'], borderWidth: 0 }] }, options: { ...defaultChartOptions, scales: { y: { beginAtZero: true, ticks: { stepSize: 1, color: '#073B4C' }, grid: { color: '#e0e0e0' }}, x: { ticks: { color: '#073B4C' }, grid: { display: false }} }, plugins: { ...defaultChartOptions.plugins, legend: { display: false }}} });
            const repRangeCtx = document.getElementById('repRangeChart').getContext('2d');
            new Chart(repRangeCtx, { type: 'doughnut', data: { labels: [ wrapLabel('Trening Siłowy (4-8 powt.)'), wrapLabel('Trening Hipertroficzny (8-12 powt.)'), wrapLabel('Wytrzymałość Mięśniowa (12+ powt.)')], datasets: [{ label: 'Podział celów', data: [35, 48, 17], backgroundColor: ['#118AB2', '#06D6A0', '#FFD166'], hoverOffset: 4, borderWidth: 0 }] }, options: { ...defaultChartOptions } });
        });
    </script>
</body>
</html>

